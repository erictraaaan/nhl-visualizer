(this["webpackJsonpnhl-visualizer"]=this["webpackJsonpnhl-visualizer"]||[]).push([[0],{102:function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),r=t(4),o=t.n(r),c=(t(78),t(8)),i=t(2),l=t.n(i),u=t(7),d=t(107),h=(t(80),function(e){var a=e.homeStats.shots+e.homeStats.missed+e.awayStats.blocks,t=a/(a+(e.awayStats.shots+e.awayStats.missed+e.homeStats.blocks))*100;return{home:t=Math.round(100*t)/100,away:Math.round(100*(100-t))/100}}),m=function(e){var a=function(e){var a=0,t=0;if(1===e.homeStats.goalies.length)a=e.homeStats.goalies[0].savePercentage;else{var s=0;e.homeStats.goalies.forEach((function(e){s+=e.savePercentage})),a=s/e.homeStats.goalies.length}1===e.awayStats.goalies.length?t=e.awayStats.goalies[0].savePercentage:(s=0,e.awayStats.goalies.forEach((function(e){s+=e.savePercentage})),t=s/e.awayStats.goalies.length);return{home:Math.round(100*a)/100,away:Math.round(100*t)/100}}(e),t=function(e){var a=100*Math.round(e.homeStats.goals/e.homeStats.shots),t=100*Math.round(e.awayStats.goals/e.awayStats.shots);return{home:Math.round(100*a)/100,away:Math.round(100*t)/100}}(e);return{home:a.home+t.home,away:a.away+t.away}},y=t(22),f=t.n(y),p=["GOAL","SHOT","MISSED_SHOT","BLOCKED_SHOT"],v=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var s="https://statsapi.web.nhl.com/api/v1/schedule?startDate=".concat(a,"&endDate=").concat(a);f.a.get(s).then((function(s){if(s.data.dates&&1===s.data.dates.length){var n=[];return s.data.dates[0].games.forEach((function(e){var a=e.gamePk,t=e.teams.home.team.id,s=e.teams.away.team.id,r=e.teams.away.score,o={gamePk:a,homeTeamID:t,homeTeamScore:e.teams.home.score,awayTeamID:s,awayTeamScore:r,homeTeamName:e.teams.home.team.name,awayTeamName:e.teams.away.team.name};n.push(o)})),e({date:a,games:n})}return t(null)})).catch((function(){return t(null)}))})));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var s="https://statsapi.web.nhl.com/api/v1/game/".concat(a,"/feed/live");f.a.get(s).then((function(t){var s=t.data.liveData.plays.scoringPlays,n=t.data.liveData.plays.playsByPeriod,r=n[2].endIndex,o=n[1].startIndex,c=n[1].endIndex,i=t.data.gameData.teams.home.id,l=t.data.gameData.teams.away.id,u={home:0,away:0},d=[];t.data.liveData.plays.allPlays.forEach((function(e){if(p.includes(e.result.eventTypeId)&&e.about.eventIdx<=r){var a,t=e.about.eventIdx;if(o<=t&&t<=c)a={x:-parseInt(e.coordinates.x),y:-parseInt(e.coordinates.y)};else a=e.coordinates;var s=e.result.eventTypeId,n=e.team.id,l=[];e.players.forEach((function(e){var a={id:e.player.id,fullName:e.player.fullName,playerType:e.playerType};l.push(a)}));var h={teamID:n,coordinates:a,eventIDx:t,eventTypeID:s,players:l};"MISSED_SHOT"===h.eventTypeID&&(h.teamID===i?u.home+=1:u.away+=1),d.push(h)}}));var h=t.data.liveData.boxscore.teams.home.teamStats.teamSkaterStats,m=h.goals,y=h.blocked,f=h.shots,v=t.data.liveData.linescore.periods[0].home.rinkSide,g=t.data.liveData.boxscore.teams.home.goalies,b=[];g.forEach((function(e){var a="ID".concat(e),s=t.data.liveData.boxscore.teams.home.players[a],n={id:s.person.id,saves:s.stats.goalieStats.saves,shots:s.stats.goalieStats.shots,savePercentage:s.stats.goalieStats.savePercentage};b.push(n)}));var j={startingRinkSide:v,id:i,goals:m,shots:f,blocks:y,goalies:b,missed:u.home},x=t.data.liveData.boxscore.teams.away.teamStats.teamSkaterStats,w=x.goals,S=x.blocked,O=x.shots,D=t.data.liveData.linescore.periods[0].away.rinkSide,T=t.data.liveData.boxscore.teams.away.goalies,k=[];T.forEach((function(e){var a="ID".concat(e),s=t.data.liveData.boxscore.teams.away.players[a],n={id:s.person.id,saves:s.stats.goalieStats.saves,shots:s.stats.goalieStats.shots,savePercentage:s.stats.goalieStats.savePercentage};k.push(n)}));var I={startingRinkSide:D,id:l,goals:w,shots:O,blocks:S,goalies:k,missed:u.away};return e({gamePK:a,scoringPlays:s,periodPlays:n,allPlays:d,homeStats:j,awayStats:I})})).catch((function(){return t(null)}))})));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),b=t(18),j=t(1),x=function(e){var a=Object(s.useRef)(null),t=["SHOT","GOAL"],n="blue",r=168;Object(s.useEffect)((function(){console.log("initial load"),o(),console.log("props: ",e),null!=e.data&&c()}),[]),Object(s.useEffect)((function(){console.log("prop changed"),o(),console.log("props: ",e),null!=e.data&&c()}),[e]);var o=function(){b.b("svg").remove()},c=function(){var e=b.b(a.current).append("svg").attr("width",410).attr("height",178);f(e,198,0,r,"red"),v(e,200,84,30,"red"),p(e,22.6,80,8,12,"blue"),p(e,371,80,8,12,"blue"),f(e,22,6,156,"red"),f(e,378,6,156,"red"),f(e,144,0,r,"blue"),f(e,252,0,r,"blue"),y(e,r,400),i(e),d(e)},i=function(a){e.data.scoringPlays.forEach((function(t){var s=e.data.allPlays.find((function(e){return e.eventIDx===t}));if(null!=s&&null!=a){var r=s.teamID===e.data.homeStats.id?"red":n,o=m(s.coordinates);v(a,o.x,o.y,2,r,r)}}))},l=function(e,a,t,s){for(var n=[],r=e;r<a;r++)for(var o=t;o<s;o++)n.push([8*r,8*o,0]);return n},u=function(e){return b.a().domain([0,4]).range(["transparent",e])},d=function(a){var s=l(0,25,0,21),r=l(25,50,0,21);e.data.allPlays.forEach((function(a){if(t.includes(a.eventTypeID)){var n=m(a.coordinates);!function(e,a){for(var t=0;t<e.length;t++)a.x>=e[t][0]&&a.x<e[t][0]+8&&a.y>=e[t][1]&&a.y<e[t][1]+8&&e[t][2]++}(a.teamID===e.data.homeStats.id?r:s,n)}}));var o=u("red"),c=u(n),i=a.append("g");h(a,r,o),h(i,s,c)},h=function(e,a,t){e.selectAll("rect").data(a).enter().append("rect").attr("rx",6).attr("ry",6).attr("x",(function(e){return e[0]})).attr("y",(function(e){return e[1]})).attr("width",8).attr("height",8).attr("fill",(function(e){return t(e[2])})).attr("opacity",.8)},m=function(a){var t=e.data.homeStats.startingRinkSide;return a.x=2*a.x,a.y=2*a.y,"right"===t&&(a.x=-a.x,a.y=-a.y),{x:a.x+200,y:a.y+84}},y=function(e,a,t){e.append("rect").attr("rx",45).attr("ry",45).attr("x",0).attr("y",0).attr("height",a).attr("width",t).style("opacity",1).style("stroke","black").style("fill","none").style("stroke-width","black")},f=function(e,a,t,s,n){e.append("rect").attr("x",a).attr("y",t).attr("height",s).attr("width","2").style("fill",n)},p=function(e,a,t,s,n,r){e.append("rect").attr("x",a).attr("y",t).attr("width",s).attr("height",n).attr("stroke",r).style("stroke-width",.5).attr("fill","#89CFF0")},v=function(e,a,t,s,n,r){e.append("circle").attr("cx",a).attr("cy",t).style("stroke-width",.5).attr("r",s).attr("stroke",n).attr("fill",r||"transparent")};return Object(j.jsx)("div",{className:"shot-visualizer-div",ref:a})},w=function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(a).then((function(e){C(e)}));case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),a=new Date,t="https://www-league.nhlstatic.com/images/logos/teams-current-primary-light/",n=Object(s.useState)(new Date),r=Object(c.a)(n,2),o=r[0],i=r[1],y=Object(s.useState)(null),f=Object(c.a)(y,2),p=f[0],b=f[1],w=Object(s.useState)(0),S=Object(c.a)(w,2),O=S[0],D=S[1],T=Object(s.useState)(null),k=Object(c.a)(T,2),I=k[0],P=k[1],N=Object(s.useState)(null),E=Object(c.a)(N,2),M=E[0],C=E[1],H=function(){var e=Object(u.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.toISOString().split("T")[0],e.next=3,v(a).then((function(e){b(e)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){0!==O&&e(O)}),[O]),Object(s.useEffect)((function(){H()}),[]),Object(s.useEffect)((function(){H()}),[o]);return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)("h1",{children:"NHL Scoring Visualizer"}),Object(j.jsx)("p",{children:"Pick a game and see some interesting scoring stats."}),Object(j.jsxs)("div",{className:"day-selector",children:[Object(j.jsx)("div",{className:"day-selector-btn",onClick:function(){var e=new Date(o.getTime()-864e5);i(e)},children:"Previous Day"}),Object(j.jsx)("div",{className:"date-display",children:Object(j.jsx)("p",{children:"".concat(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()],", ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]," ").concat(o.getDate())})}),Object(j.jsx)("div",{className:"day-selector-btn"+(o.setHours(0,0,0,0)===a.setHours(0,0,0,0)?" hide":""),onClick:function(){var e=new Date(o.getTime()+864e5);i(e)},children:"Next Day"})]}),p&&p.games.map((function(e,a){return Object(j.jsx)("div",{className:"card level-3",onClick:function(){P(e),D(e.gamePk)},children:Object(j.jsxs)("div",{className:"teams",children:[Object(j.jsxs)("div",{className:"team-display",children:[Object(j.jsx)("img",{alt:"away team logo",src:"".concat(t).concat(e.awayTeamID,".svg"),className:"scorebug-logo"}),Object(j.jsx)("p",{className:"team-name",children:e.awayTeamName})]}),Object(j.jsx)("div",{className:"score",children:Object(j.jsxs)("p",{children:[e.awayTeamScore," - ",e.homeTeamScore," "]})}),Object(j.jsxs)("div",{className:"team-display",children:[Object(j.jsx)("img",{alt:"home team logo",src:"".concat(t).concat(e.homeTeamID,".svg"),className:"scorebug-logo"}),Object(j.jsx)("p",{className:"team-name",children:e.homeTeamName})]})]})},a)})),0!==O&&M&&I&&Object(j.jsx)(d.a,{open:0!==O,onClose:function(){D(0)},children:Object(j.jsxs)("div",{className:"modal card",children:[Object(j.jsxs)("p",{children:[I.awayTeamName," vs. ",I.homeTeamName]}),Object(j.jsxs)("p",{children:[I.awayTeamScore," - ",I.homeTeamScore]}),Object(j.jsxs)("p",{children:["Home Corsi: ",h(M).home,"%"]}),Object(j.jsxs)("p",{children:["Away Corsi: ",h(M).away,"%"]}),Object(j.jsxs)("p",{children:["Home PDO: ",m(M).home]}),Object(j.jsxs)("p",{children:["Away PDO: ",m(M).away]}),Object(j.jsx)(x,{data:M})]})}),Object(j.jsx)("div",{className:"footer",children:Object(j.jsx)("p",{children:"Made by Eric Tran using public data available through the NHL API."})})]})},S=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,108)).then((function(a){var t=a.getCLS,s=a.getFID,n=a.getFCP,r=a.getLCP,o=a.getTTFB;t(e),s(e),n(e),r(e),o(e)}))};o.a.render(Object(j.jsx)(n.a.StrictMode,{children:Object(j.jsx)(w,{})}),document.getElementById("root")),S()},78:function(e,a,t){},80:function(e,a,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.b7c0f5a6.chunk.js.map
(this["webpackJsonpnhl-visualizer"]=this["webpackJsonpnhl-visualizer"]||[]).push([[0],{102:function(t,a,e){"use strict";e.r(a);var n=e(0),r=e.n(n),s=e(4),o=e.n(s),i=(e(78),e(17)),c=e(2),l=e.n(c),u=e(7),d=e(107),h=(e(80),function(t){var a=t.homeStats.shots+t.homeStats.missed+t.awayStats.blocks,e=a/(a+(t.awayStats.shots+t.awayStats.missed+t.homeStats.blocks))*100;return{home:e=Math.round(100*e)/100,away:Math.round(100*(100-e))/100}}),m=function(t){var a=function(t){var a=0,e=0;if(1==t.homeStats.goalies.length)a=t.homeStats.goalies[0].savePercentage;else{var n=0;t.homeStats.goalies.forEach((function(t){n+=t.savePercentage})),a=n/t.homeStats.goalies.length}1==t.awayStats.goalies.length?e=t.awayStats.goalies[0].savePercentage:(n=0,t.awayStats.goalies.forEach((function(t){n+=t.savePercentage})),e=n/t.awayStats.goalies.length);return{home:Math.round(100*a)/100,away:Math.round(100*e)/100}}(t),e=function(t){var a=100*Math.round(t.homeStats.goals/t.homeStats.shots),e=100*Math.round(t.awayStats.goals/t.awayStats.shots);return{home:Math.round(100*a)/100,away:Math.round(100*e)/100}}(t);return{home:a.home+e.home,away:a.away+e.away}},f=e(21),p=e.n(f),y=["GOAL","SHOT","MISSED_SHOT","BLOCKED_SHOT"],v=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var n="https://statsapi.web.nhl.com/api/v1/schedule?startDate=".concat(a,"&endDate=").concat(a);p.a.get(n).then((function(n){if(console.log("raw: ",n),n.data.dates&&1===n.data.dates.length){var r=[];n.data.dates[0].games.forEach((function(t){var a=t.gamePk,e=t.teams.home.team.id,n=t.teams.away.team.id,s=t.teams.away.score,o={gamePk:a,homeTeamID:e,homeTeamScore:t.teams.home.score,awayTeamID:n,awayTeamScore:s,homeTeamName:t.teams.home.team.name,awayTeamName:t.teams.away.team.name};r.push(o)}));var s={date:a,games:r};return console.log("output: ",s),t(s)}return e(null)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),g=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var n="https://statsapi.web.nhl.com/api/v1/game/".concat(a,"/feed/live");p.a.get(n).then((function(e){console.log("raw: ",e);var n=e.data.liveData.plays.scoringPlays,r=e.data.liveData.plays.playsByPeriod,s=r[2].endIndex,o=r[1].startIndex,i=r[1].endIndex,c=e.data.gameData.teams.home.id,l=e.data.gameData.teams.away.id,u={home:0,away:0},d=[];e.data.liveData.plays.allPlays.forEach((function(t){if(y.includes(t.result.eventTypeId)&&t.about.eventIdx<=s){var a,e=t.about.eventIdx;if(o<=e&&e<=i)a={x:-parseInt(t.coordinates.x),y:-parseInt(t.coordinates.y)};else a=t.coordinates;var n=t.result.eventTypeId,r=t.team.id,l=[];t.players.forEach((function(t){var a={id:t.player.id,fullName:t.player.fullName,playerType:t.playerType};l.push(a)}));var h={teamID:r,coordinates:a,eventIDx:e,eventTypeID:n,players:l};"MISSED_SHOT"===h.eventTypeID&&(h.teamID===c?u.home+=1:u.away+=1),d.push(h)}}));var h=e.data.liveData.boxscore.teams.home.teamStats.teamSkaterStats,m=h.goals,f=h.blocked,p=h.shots,v=e.data.liveData.linescore.periods[0].home.rinkSide,g=e.data.liveData.boxscore.teams.home.goalies,b=[];g.forEach((function(t){var a="ID".concat(t),n=e.data.liveData.boxscore.teams.home.players[a],r={id:n.person.id,saves:n.stats.goalieStats.saves,shots:n.stats.goalieStats.shots,savePercentage:n.stats.goalieStats.savePercentage};b.push(r)}));var w={startingRinkSide:v,id:c,goals:m,shots:p,blocks:f,goalies:b,missed:u.home},S=e.data.liveData.boxscore.teams.away.teamStats.teamSkaterStats,x=S.goals,j=S.blocked,O=S.shots,D=e.data.liveData.linescore.periods[0].away.rinkSide,k=e.data.liveData.boxscore.teams.away.goalies,P=[];k.forEach((function(t){var a="ID".concat(t),n=e.data.liveData.boxscore.teams.away.players[a],r={id:n.person.id,saves:n.stats.goalieStats.saves,shots:n.stats.goalieStats.shots,savePercentage:n.stats.goalieStats.savePercentage};P.push(r)}));var I={startingRinkSide:D,id:l,goals:x,shots:O,blocks:j,goalies:P,missed:u.away},T={gamePK:a,scoringPlays:n,periodPlays:r,allPlays:d,homeStats:w,awayStats:I};return console.log("details: ",T),t(T)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),b=e(22),w=e(1),S=function(t){var a=Object(n.useRef)(null),e="blue",r=168;Object(n.useEffect)((function(){null!=t.data&&s()}),[]);var s=function(){var t=b.b(a.current).append("svg").attr("width",410).attr("height",178);m(t,198,0,r,"red"),f(t,22.6,80,8,12,"blue"),f(t,371,80,8,12,"blue"),m(t,22,6,156,"red"),m(t,378,6,156,"red"),m(t,144,0,r,"blue"),m(t,252,0,r,"blue"),h(t,r,400),o(t),l(t)},o=function(a){t.data.scoringPlays.forEach((function(n){var r=t.data.allPlays.find((function(t){return t.eventIDx===n}));if(null!=r&&null!=a){var s=r.teamID==t.data.homeStats.id?"red":e,o=d(r.coordinates);p(a,o.x,o.y,2,s,s)}}))},i=function(t,a,e,n){for(var r=[],s=t;s<a;s++)for(var o=e;o<n;o++)r.push([8*s,8*o,0]);return r},c=function(t){return b.a().domain([0,4]).range(["transparent",t])},l=function(a){var n=i(0,25,0,21),r=i(25,50,0,21);t.data.allPlays.forEach((function(a){if("SHOT"==a.eventTypeID){var e=d(a.coordinates);!function(t,a){for(var e=0;e<t.length;e++)a.x>=t[e][0]&&a.x<t[e][0]+8&&a.y>=t[e][1]&&a.y<t[e][1]+8&&t[e][2]++}(a.teamID==t.data.homeStats.id?r:n,e)}}));var s=c("red"),o=c(e),l=a.append("g");u(a,r,s),u(l,n,o)},u=function(t,a,e){t.selectAll("rect").data(a).enter().append("rect").attr("rx",6).attr("ry",6).attr("x",(function(t){return t[0]})).attr("y",(function(t){return t[1]})).attr("width",8).attr("height",8).attr("fill",(function(t){return e(t[2])})).attr("opacity",.8)},d=function(a){var e=t.data.homeStats.startingRinkSide;return a.x=2*a.x,a.y=2*a.y,"right"==e&&(a.x=-a.x,a.y=-a.y),{x:a.x+200,y:a.y+84}},h=function(t,a,e){t.append("rect").attr("rx",45).attr("ry",45).attr("x",0).attr("y",0).attr("height",a).attr("width",e).style("opacity",1).style("stroke","black").style("fill","none").style("stroke-width","black")},m=function(t,a,e,n,r){t.append("rect").attr("x",a).attr("y",e).attr("height",n).attr("width","2").style("fill",r)},f=function(t,a,e,n,r,s){t.append("rect").attr("x",a).attr("y",e).attr("width",n).attr("height",r).attr("stroke",s).style("stroke-width",.5).attr("fill","#89CFF0")},p=function(t,a,e,n,r,s){t.append("circle").attr("cx",a).attr("cy",e).style("stroke-width",.5).attr("r",n).attr("stroke",r).attr("fill",s||"transparent")};return Object(w.jsx)("div",{className:"shot-visualizer-div",ref:a})},x=function(){var t=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(a).then((function(t){j(t)}));case 2:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),a=Object(n.useState)(null),e=Object(i.a)(a,2),r=e[0],s=e[1],o=Object(n.useState)(0),c=Object(i.a)(o,2),f=c[0],p=c[1],y=Object(n.useState)(null),b=Object(i.a)(y,2),x=b[0],j=b[1],O=function(){var t=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v("2021-12-04").then((function(t){s(t)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){0!==f&&t(f)}),[f]),Object(n.useEffect)((function(){O()}),[]),Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)("h1",{children:"NHL Scoring Visualizer"}),Object(w.jsx)("p",{children:"Pick a game and see some interesting scoring stats."}),Object(w.jsx)("p",{children:"Made using the public NHL API."}),r&&r.games.map((function(t,a){return Object(w.jsxs)("div",{className:"card level-3",onClick:function(){p(t.gamePk)},children:[Object(w.jsxs)("h5",{children:[t.awayTeamName," vs ",t.homeTeamName]}),Object(w.jsxs)("p",{children:[t.awayTeamScore," - ",t.homeTeamScore," "]})]},a)})),0!==f&&x&&Object(w.jsx)(d.a,{open:0!==f,onClose:function(){p(0)},children:Object(w.jsxs)("div",{className:"modal card",children:[Object(w.jsx)("p",{children:x.gamePK}),Object(w.jsxs)("p",{children:["Home Corsi: ",h(x).home,"%"]}),Object(w.jsxs)("p",{children:["Away Corsi: ",h(x).away,"%"]}),Object(w.jsxs)("p",{children:["Home PDO: ",m(x).home]}),Object(w.jsxs)("p",{children:["Away PDO: ",m(x).away]}),Object(w.jsx)(S,{data:x})]})})]})},j=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,108)).then((function(a){var e=a.getCLS,n=a.getFID,r=a.getFCP,s=a.getLCP,o=a.getTTFB;e(t),n(t),r(t),s(t),o(t)}))};o.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(x,{})}),document.getElementById("root")),j()},78:function(t,a,e){},80:function(t,a,e){}},[[102,1,2]]]);
//# sourceMappingURL=main.3e204283.chunk.js.map
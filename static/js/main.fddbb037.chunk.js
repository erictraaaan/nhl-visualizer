(this["webpackJsonpnhl-visualizer"]=this["webpackJsonpnhl-visualizer"]||[]).push([[0],{64:function(t,a,e){},66:function(t,a,e){},88:function(t,a,e){"use strict";e.r(a);var s=e(0),n=e.n(s),r=e(4),o=e.n(r),i=(e(64),e(14)),c=e(3),l=e.n(c),u=e(7),h=e(93),d=(e(66),function(t){var a=t.homeStats.shots+t.homeStats.missed+t.awayStats.blocks,e=a/(a+(t.awayStats.shots+t.awayStats.missed+t.homeStats.blocks))*100;return{home:e,away:100-e}}),m=function(t){var a=function(t){var a=0,e=0;if(1==t.homeStats.goalies.length)a=t.homeStats.goalies[0].savePercentage;else{var s=0;t.homeStats.goalies.forEach((function(t){s+=t.savePercentage})),a=s/t.homeStats.goalies.length}1==t.awayStats.goalies.length?e=t.awayStats.goalies[0].savePercentage:(s=0,t.awayStats.goalies.forEach((function(t){s+=t.savePercentage})),e=s/t.awayStats.goalies.length);return{home:a,away:e}}(t),e=function(t){return{home:100*Math.round(t.homeStats.goals/t.homeStats.shots),away:100*Math.round(t.awayStats.goals/t.awayStats.shots)}}(t);return{home:a.home+e.home,away:a.away+e.away}},f=e(18),p=e.n(f),y=["GOAL","SHOT","MISSED_SHOT","BLOCKED_SHOT"],g=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var s="https://statsapi.web.nhl.com/api/v1/schedule?startDate=".concat(a,"&endDate=").concat(a);p.a.get(s).then((function(s){if(console.log("raw: ",s),s.data.dates&&1===s.data.dates.length){console.log("in here");var n=[];s.data.dates[0].games.forEach((function(t){var a=t.gamePk,e=t.teams.home.team.id,s=t.teams.away.team.id,r=t.teams.away.score,o={gamePk:a,homeTeamID:e,homeTeamScore:t.teams.home.score,awayTeamID:s,awayTeamScore:r,homeTeamName:t.teams.home.team.name,awayTeamName:t.teams.away.team.name};n.push(o)}));var r={date:a,games:n};return console.log("output: ",r),t(r)}return e(null)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),v=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var s="https://statsapi.web.nhl.com/api/v1/game/".concat(a,"/feed/live");p.a.get(s).then((function(e){console.log("raw: ",e);var s=e.data.liveData.plays.scoringPlays,n=e.data.liveData.plays.playsByPeriod,r=n[2].endIndex,o=n[1].startIndex,i=n[1].endIndex,c=e.data.gameData.teams.home.id,l=e.data.gameData.teams.away.id,u={home:0,away:0},h=[];e.data.liveData.plays.allPlays.forEach((function(t){if(y.includes(t.result.eventTypeId)&&t.about.eventIdx<=r){var a,e=t.about.eventIdx;if(o<=e&&e<=i)a={x:-parseInt(t.coordinates.x),y:-parseInt(t.coordinates.y)};else a=t.coordinates;var s=t.result.eventTypeId,n=t.team.id,l=[];t.players.forEach((function(t){var a={id:t.player.id,fullName:t.player.fullName,playerType:t.playerType};l.push(a)}));var d={teamID:n,coordinates:a,eventIDx:e,eventTypeID:s,players:l};"MISSED_SHOT"===d.eventTypeID&&(d.teamID===c?u.home+=1:u.away+=1),h.push(d)}}));var d=e.data.liveData.boxscore.teams.home.teamStats.teamSkaterStats,m=d.goals,f=d.blocked,p=d.shots,g=e.data.liveData.linescore.periods[0].home.rinkSide,v=e.data.liveData.boxscore.teams.home.goalies,w=[];v.forEach((function(t){var a="ID".concat(t),s=e.data.liveData.boxscore.teams.home.players[a],n={id:s.person.id,saves:s.stats.goalieStats.saves,shots:s.stats.goalieStats.shots,savePercentage:s.stats.goalieStats.savePercentage};w.push(n)}));var b={startingRinkSide:g,id:c,goals:m,shots:p,blocks:f,goalies:w,missed:u.home},S=e.data.liveData.boxscore.teams.away.teamStats.teamSkaterStats,x=S.goals,j=S.blocked,O=S.shots,k=e.data.liveData.linescore.periods[0].away.rinkSide,D=e.data.liveData.boxscore.teams.away.goalies,P=[];D.forEach((function(t){var a="ID".concat(t),s=e.data.liveData.boxscore.teams.away.players[a],n={id:s.person.id,saves:s.stats.goalieStats.saves,shots:s.stats.goalieStats.shots,savePercentage:s.stats.goalieStats.savePercentage};P.push(n)}));var I={startingRinkSide:k,id:l,goals:x,shots:O,blocks:j,goalies:P,missed:u.away},T={gamePK:a,scoringPlays:s,periodPlays:n,allPlays:h,homeStats:b,awayStats:I};return console.log("details: ",T),t(T)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),w=e(32),b=e(1),S=function(t){var a=Object(s.useRef)(null);Object(s.useEffect)((function(){null!=t.data&&e()}),[]);var e=function(){var t=w.a(a.current).append("svg").attr("width",200).attr("height",85);o(t),l(t,100,42.5,15,"red"),i(t,100,0,100,85,"red"),c(t,10,38.5,4,8,"blue"),c(t,186,38.5,4,8,"blue"),i(t,10,2.5,10,82.5,"red"),i(t,190,2.5,190,82.5,"red"),i(t,70,0,70,85,"blue"),i(t,130,0,130,85,"blue"),n(t)},n=function(a){console.log("plotting goals"),t.data.scoringPlays.forEach((function(e){var s=t.data.allPlays.find((function(t){return t.eventIDx===e}));if(null!=s&&null!=a){var n=s.teamID==t.data.homeStats.id?"red":"blue",o=r(s.coordinates);a.append("circle").attr("cx",o.x).attr("cy",o.y).attr("r",1).attr("stroke",n).attr("fill",n)}}))},r=function(a){return"right"==t.data.homeStats.startingRinkSide&&(a.x=-a.x,a.y=-a.y),{x:a.x+100,y:a.y+42.5}},o=function(t){t.append("rect").attr("rx",20).attr("ry",20).attr("x",0).attr("y",0).attr("height",85).attr("width",200).style("opacity",1).style("fill","white").style("stroke","white").style("stroke-width",4)},i=function(t,a,e,s,n,r){t.append("line").style("stroke",r).style("stroke-width",1).attr("x1",a).attr("y1",e).attr("x2",s).attr("y2",n)},c=function(t,a,e,s,n,r){t.append("rect").attr("x",a).attr("y",e).attr("width",s).attr("height",n).attr("stroke",r).style("stroke-width",.5).attr("fill","#89CFF0")},l=function(t,a,e,s,n){t.append("circle").attr("cx",a).attr("cy",e).style("stroke-width",.5).attr("r",s).attr("stroke",n).attr("fill","white")};return Object(b.jsx)("div",{className:"shot-visualizer-div",ref:a})},x=function(){var t=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(a).then((function(t){j(t)}));case 2:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),a=Object(s.useState)(null),e=Object(i.a)(a,2),n=e[0],r=e[1],o=Object(s.useState)(0),c=Object(i.a)(o,2),f=c[0],p=c[1],y=Object(s.useState)(null),w=Object(i.a)(y,2),x=w[0],j=w[1],O=function(){var t=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g("2021-12-04").then((function(t){r(t)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(s.useEffect)((function(){0!==f&&t(f)}),[f]),Object(s.useEffect)((function(){O()}),[]),Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("h1",{children:"NHL Scoring Visualizer"}),Object(b.jsx)("p",{children:"Pick a game and see some interesting scoring stats."}),Object(b.jsx)("p",{children:"Made using the public NHL API."}),n&&n.games.map((function(t,a){return Object(b.jsxs)("div",{className:"card level-3",onClick:function(){p(t.gamePk)},children:[Object(b.jsxs)("h5",{children:[t.awayTeamName," vs ",t.homeTeamName]}),Object(b.jsxs)("p",{children:[t.awayTeamScore," - ",t.homeTeamScore," "]})]},a)})),0!==f&&x&&Object(b.jsx)(h.a,{open:0!==f,onClose:function(){p(0)},children:Object(b.jsxs)("div",{className:"modal card",children:[Object(b.jsx)("p",{children:x.gamePK}),Object(b.jsxs)("p",{children:["Home Corsi: ",d(x).home,"%"]}),Object(b.jsxs)("p",{children:["Away Corsi: ",d(x).away,"%"]}),Object(b.jsxs)("p",{children:["Home PDO: ",m(x).home]}),Object(b.jsxs)("p",{children:["Away PDO: ",m(x).away]}),Object(b.jsx)(S,{data:x})]})})]})},j=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,94)).then((function(a){var e=a.getCLS,s=a.getFID,n=a.getFCP,r=a.getLCP,o=a.getTTFB;e(t),s(t),n(t),r(t),o(t)}))};o.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(x,{})}),document.getElementById("root")),j()}},[[88,1,2]]]);
//# sourceMappingURL=main.fddbb037.chunk.js.map
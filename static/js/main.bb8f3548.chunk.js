(this["webpackJsonpnhl-visualizer"]=this["webpackJsonpnhl-visualizer"]||[]).push([[0],{102:function(t,a,e){"use strict";e.r(a);var n=e(0),s=e.n(n),r=e(4),o=e.n(r),c=(e(78),e(8)),i=e(2),l=e.n(i),u=e(7),d=e(107),h=(e(80),function(t){var a=t.homeStats.shots+t.homeStats.missed+t.awayStats.blocks,e=a/(a+(t.awayStats.shots+t.awayStats.missed+t.homeStats.blocks))*100;return{home:e=Math.round(100*e)/100,away:Math.round(100*(100-e))/100}}),m=function(t){var a=function(t){var a=0,e=0;if(1==t.homeStats.goalies.length)a=t.homeStats.goalies[0].savePercentage;else{var n=0;t.homeStats.goalies.forEach((function(t){n+=t.savePercentage})),a=n/t.homeStats.goalies.length}1==t.awayStats.goalies.length?e=t.awayStats.goalies[0].savePercentage:(n=0,t.awayStats.goalies.forEach((function(t){n+=t.savePercentage})),e=n/t.awayStats.goalies.length);return{home:Math.round(100*a)/100,away:Math.round(100*e)/100}}(t),e=function(t){var a=100*Math.round(t.homeStats.goals/t.homeStats.shots),e=100*Math.round(t.awayStats.goals/t.awayStats.shots);return{home:Math.round(100*a)/100,away:Math.round(100*e)/100}}(t);return{home:a.home+e.home,away:a.away+e.away}},y=e(22),f=e.n(y),p=["GOAL","SHOT","MISSED_SHOT","BLOCKED_SHOT"],v=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var n="https://statsapi.web.nhl.com/api/v1/schedule?startDate=".concat(a,"&endDate=").concat(a);f.a.get(n).then((function(n){if(console.log("raw: ",n),n.data.dates&&1===n.data.dates.length){var s=[];n.data.dates[0].games.forEach((function(t){var a=t.gamePk,e=t.teams.home.team.id,n=t.teams.away.team.id,r=t.teams.away.score,o={gamePk:a,homeTeamID:e,homeTeamScore:t.teams.home.score,awayTeamID:n,awayTeamScore:r,homeTeamName:t.teams.home.team.name,awayTeamName:t.teams.away.team.name};s.push(o)}));var r={date:a,games:s};return console.log("output: ",r),t(r)}return e(null)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),g=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var n="https://statsapi.web.nhl.com/api/v1/game/".concat(a,"/feed/live");f.a.get(n).then((function(e){console.log("raw: ",e);var n=e.data.liveData.plays.scoringPlays,s=e.data.liveData.plays.playsByPeriod,r=s[2].endIndex,o=s[1].startIndex,c=s[1].endIndex,i=e.data.gameData.teams.home.id,l=e.data.gameData.teams.away.id,u={home:0,away:0},d=[];e.data.liveData.plays.allPlays.forEach((function(t){if(p.includes(t.result.eventTypeId)&&t.about.eventIdx<=r){var a,e=t.about.eventIdx;if(o<=e&&e<=c)a={x:-parseInt(t.coordinates.x),y:-parseInt(t.coordinates.y)};else a=t.coordinates;var n=t.result.eventTypeId,s=t.team.id,l=[];t.players.forEach((function(t){var a={id:t.player.id,fullName:t.player.fullName,playerType:t.playerType};l.push(a)}));var h={teamID:s,coordinates:a,eventIDx:e,eventTypeID:n,players:l};"MISSED_SHOT"===h.eventTypeID&&(h.teamID===i?u.home+=1:u.away+=1),d.push(h)}}));var h=e.data.liveData.boxscore.teams.home.teamStats.teamSkaterStats,m=h.goals,y=h.blocked,f=h.shots,v=e.data.liveData.linescore.periods[0].home.rinkSide,g=e.data.liveData.boxscore.teams.home.goalies,b=[];g.forEach((function(t){var a="ID".concat(t),n=e.data.liveData.boxscore.teams.home.players[a],s={id:n.person.id,saves:n.stats.goalieStats.saves,shots:n.stats.goalieStats.shots,savePercentage:n.stats.goalieStats.savePercentage};b.push(s)}));var j={startingRinkSide:v,id:i,goals:m,shots:f,blocks:y,goalies:b,missed:u.home},w=e.data.liveData.boxscore.teams.away.teamStats.teamSkaterStats,S=w.goals,x=w.blocked,O=w.shots,D=e.data.liveData.linescore.periods[0].away.rinkSide,T=e.data.liveData.boxscore.teams.away.goalies,k=[];T.forEach((function(t){var a="ID".concat(t),n=e.data.liveData.boxscore.teams.away.players[a],s={id:n.person.id,saves:n.stats.goalieStats.saves,shots:n.stats.goalieStats.shots,savePercentage:n.stats.goalieStats.savePercentage};k.push(s)}));var I={startingRinkSide:D,id:l,goals:S,shots:O,blocks:x,goalies:k,missed:u.away},P={gamePK:a,scoringPlays:n,periodPlays:s,allPlays:d,homeStats:j,awayStats:I};return console.log("details: ",P),t(P)})).catch((function(){return e(null)}))})));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),b=e(18),j=e(1),w=function(t){var a=Object(n.useRef)(null),e=["SHOT","GOAL"],s="blue",r=168;Object(n.useEffect)((function(){o(),null!=t.data&&c()}),[]);var o=function(){b.b("svg").remove()},c=function(){var t=b.b(a.current).append("svg").attr("width",410).attr("height",178);f(t,198,0,r,"red"),v(t,200,84,30,"red"),p(t,22.6,80,8,12,"blue"),p(t,371,80,8,12,"blue"),f(t,22,6,156,"red"),f(t,378,6,156,"red"),f(t,144,0,r,"blue"),f(t,252,0,r,"blue"),y(t,r,400),i(t),d(t)},i=function(a){t.data.scoringPlays.forEach((function(e){var n=t.data.allPlays.find((function(t){return t.eventIDx===e}));if(null!=n&&null!=a){var r=n.teamID==t.data.homeStats.id?"red":s,o=m(n.coordinates);v(a,o.x,o.y,2,r,r)}}))},l=function(t,a,e,n){for(var s=[],r=t;r<a;r++)for(var o=e;o<n;o++)s.push([8*r,8*o,0]);return s},u=function(t){return b.a().domain([0,4]).range(["transparent",t])},d=function(a){var n=l(0,25,0,21),r=l(25,50,0,21);t.data.allPlays.forEach((function(a){if(e.includes(a.eventTypeID)){var s=m(a.coordinates);!function(t,a){for(var e=0;e<t.length;e++)a.x>=t[e][0]&&a.x<t[e][0]+8&&a.y>=t[e][1]&&a.y<t[e][1]+8&&t[e][2]++}(a.teamID==t.data.homeStats.id?r:n,s)}}));var o=u("red"),c=u(s),i=a.append("g");h(a,r,o),h(i,n,c)},h=function(t,a,e){t.selectAll("rect").data(a).enter().append("rect").attr("rx",6).attr("ry",6).attr("x",(function(t){return t[0]})).attr("y",(function(t){return t[1]})).attr("width",8).attr("height",8).attr("fill",(function(t){return e(t[2])})).attr("opacity",.8)},m=function(a){var e=t.data.homeStats.startingRinkSide;return a.x=2*a.x,a.y=2*a.y,"right"==e&&(a.x=-a.x,a.y=-a.y),{x:a.x+200,y:a.y+84}},y=function(t,a,e){t.append("rect").attr("rx",45).attr("ry",45).attr("x",0).attr("y",0).attr("height",a).attr("width",e).style("opacity",1).style("stroke","black").style("fill","none").style("stroke-width","black")},f=function(t,a,e,n,s){t.append("rect").attr("x",a).attr("y",e).attr("height",n).attr("width","2").style("fill",s)},p=function(t,a,e,n,s,r){t.append("rect").attr("x",a).attr("y",e).attr("width",n).attr("height",s).attr("stroke",r).style("stroke-width",.5).attr("fill","#89CFF0")},v=function(t,a,e,n,s,r){t.append("circle").attr("cx",a).attr("cy",e).style("stroke-width",.5).attr("r",n).attr("stroke",s).attr("fill",r||"transparent")};return Object(j.jsx)("div",{className:"shot-visualizer-div",ref:a})},S=function(){var t=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(a).then((function(t){C(t)}));case 2:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),a=new Date,e="https://www-league.nhlstatic.com/images/logos/teams-current-primary-light/",s=Object(n.useState)(new Date),r=Object(c.a)(s,2),o=r[0],i=r[1],y=Object(n.useState)(null),f=Object(c.a)(y,2),p=f[0],b=f[1],S=Object(n.useState)(0),x=Object(c.a)(S,2),O=x[0],D=x[1],T=Object(n.useState)(null),k=Object(c.a)(T,2),I=k[0],P=k[1],N=Object(n.useState)(null),E=Object(c.a)(N,2),M=E[0],C=E[1],H=function(){var t=Object(u.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.toISOString().split("T")[0],t.next=3,v(a).then((function(t){b(t)}));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){0!==O&&t(O)}),[O]),Object(n.useEffect)((function(){H()}),[]),Object(n.useEffect)((function(){H()}),[o]);return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)("h1",{children:"NHL Scoring Visualizer"}),Object(j.jsx)("p",{children:"Pick a game and see some interesting scoring stats."}),Object(j.jsxs)("div",{className:"day-selector",children:[Object(j.jsx)("button",{className:"day-selector-btn",onClick:function(){var t=new Date(o.getTime()-864e5);i(t)},children:"Previous Day"}),Object(j.jsx)("p",{children:"".concat(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()],", ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]," ").concat(o.getDate())}),Object(j.jsx)("button",{className:"day-selector-btn"+(o.setHours(0,0,0,0)==a.setHours(0,0,0,0)?" hide":""),onClick:function(){var t=new Date(o.getTime()+864e5);i(t)},children:"Next Day"})]}),p&&p.games.map((function(t,a){return Object(j.jsxs)("div",{className:"card level-3",onClick:function(){P(t),D(t.gamePk)},children:[Object(j.jsx)("img",{src:"".concat(e).concat(t.awayTeamID,".svg"),className:"scorebug-logo"}),Object(j.jsxs)("h5",{children:[t.awayTeamName," vs ",t.homeTeamName]}),Object(j.jsx)("img",{src:"".concat(e).concat(t.homeTeamID,".svg"),className:"scorebug-logo"}),Object(j.jsxs)("p",{children:[t.awayTeamScore," - ",t.homeTeamScore," "]})]},a)})),0!==O&&M&&I&&Object(j.jsx)(d.a,{open:0!==O,onClose:function(){D(0)},children:Object(j.jsxs)("div",{className:"modal card",children:[Object(j.jsxs)("p",{children:[I.awayTeamName," vs. ",I.homeTeamName]}),Object(j.jsxs)("p",{children:[I.awayTeamScore," - ",I.homeTeamScore]}),Object(j.jsxs)("p",{children:["Home Corsi: ",h(M).home,"%"]}),Object(j.jsxs)("p",{children:["Away Corsi: ",h(M).away,"%"]}),Object(j.jsxs)("p",{children:["Home PDO: ",m(M).home]}),Object(j.jsxs)("p",{children:["Away PDO: ",m(M).away]}),Object(j.jsx)(w,{data:M})]})}),Object(j.jsx)("div",{className:"footer",children:Object(j.jsx)("p",{children:"Made by Eric Tran using public data available through the NHL API."})})]})},x=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,108)).then((function(a){var e=a.getCLS,n=a.getFID,s=a.getFCP,r=a.getLCP,o=a.getTTFB;e(t),n(t),s(t),r(t),o(t)}))};o.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(S,{})}),document.getElementById("root")),x()},78:function(t,a,e){},80:function(t,a,e){}},[[102,1,2]]]);
//# sourceMappingURL=main.bb8f3548.chunk.js.map